City on Fire

The undercover cop Chan Kam-wah (who was investigating a group of jewelry thieves) blows his cover and is stabbed to death by three attackers on a public marketplace. His superior inspector Lau orders Ko Chow, another undercover policeman, to resume the investigations. Ko Chow only accepts reluctantly. He would prefer not to perform another undercover assignment, since he had to arrest someone during his last mission who had trusted him as a friend.
The robbers are holding up a jewellery factory, but someone manages to alarm the police. After a firefight with the approaching policemen the gang has a narrow escape. The police commissioner sets up dedicated task force to investigate the gang under the leadership of the young inspector John Chan. A strong rivalry develops between Lau and Chan; Chan considers Lau old-fashioned and out of his depth, while Lau considers Chan inexperienced and arrogant.
To reach out to the gang, Chow offers the gang weapons for sale through the middle man Tai Song. During a first meeting with gang member Fu they are tailed by members of the Criminal Investigation Division under the command of Chan (who is unaware that Chow is an undercover policeman). After the funeral of Kam-wah Chow meets with Lau who hands him a key to a locker in a bowling alley where the weapons will be stashed. Chow advises against handing out real guns, but Lau insists to not to lose track of the gang. He argues they would get guns on the black market anyway.
Chow meets with his girlfriend Hung, who he made a marriage proposal shortly before. The appointment in the register office is in two days at 10pm. When Chow asks her to postpone the marriage until his case is closed, she leaves the room hysterically.
Prior to the handover of the guns Chow tapes a recorder around his waists. He meets with three of the gang members. Chow is patted down, but manages to distract them from the tape recorder. Fu is satisfied with the provided gun and instructs Chow to meet him again in two days at noon to buy additional guns and ammunition.
The next day Chow meets with Lau and asks him for additional weapons. Lau needs time to get them, but assures to deposit them by 10am tomorrow (i.e. two hours before the arranged handover to Fu) in the bowling alley. Meanwhile Hung packs her bags to take a flight to Canada with Tso, an older business man who had offered before to leave his wife for her. When Chow learns about that on the telephone, he asks her to marry him immediately to change her mind. Hung tells him to prove he's sincere by showing up at the register office at 10am the next day. The following day she waits there in vain with her friend Rose.
On his way to the bowling alley Chow is tailed by policemen. When he realises (and since having the guns in a felony) he calls Lau. Lau tells him that the policemen are from Chan's department and orders him to proceed while he would sort out the situation with Chan. When talking to Chan he mentions Chow as an informer, but keeps his status as an undercover cop a secret. Chan refuses Lau's request to let go of Chow and asks him to leave his office.
Now on his own Chow shakes off his pursuers at an MTR station by boarding a departing metro car. While getting the bag with the guns, he notices Fu at the bowling alley. As he leaves the building, the police arrives. Chow manages to escape by jumping from a window and is picked up at street level by Fu who's approaching in a car. They drive to the gang's hideout since their leader wants to meet Chow. He offers Chow to participate in an upcoming big holdup.
Fu drives Chow to the airport where he meets Hung, who's about to board a plane to Canada with Tso. Chow tries to change her mind, but is arrested by the police for selling weapons (while Hung board the plane). At the police station, Chow is beat up and tortured by Chan's men to learn about the buyer of the weapons. When Lau enters the room, he threatens Chan with a gun. Their superior enters the room, orders to release Chow and calls Chan and Lau into his office. Lau admits to have given Chow the weapons for the weapons deal, but keeps quiet about Chow being an undercover cop. Since illegal possession of a firearm is an offense which would only result in minor sentences, Chan proposes that Chow participates in the holdup to catch the robbers red-handed. Lau considers that too much of a risk, but ultimately the police chief orders Chows participation in the planned robbery.
There are four possible jewelry stores the gang might rob, all have weak security measures, valuable merchandise and are located at busy roads. After the robbery, the gang plans to drive to a hideout in the harbour area where a boat is about to pick them up the following day. The police is unaware of the targeted store, but plans to hold a SWAT team ready.
On the eve of the robbery the gang leader orders them to gather at a flat. For security reasons they need to spend the remaining time before the holdout together and hand out their pagers. Chow writes the address of the hideout on a piece of paper, but is unable to pass this to his police colleagues, so it ends up in his wallet. Chow and Fu share a room and talk about their history and future plans: Fu is illiterate, his father was also a thief who got killed by the police - while robbing a police station - ten years ago. His wife left him and he never saw his son again. Chow tells him that his wife also left him and both men become increasingly close. In the night Chow reads a letter from Hung who tells him that she didn't go to Canada with Tso, but is waiting for him in Hawaii.
The next morning the police leadership orders the SWAT team out of standby since they don't expect the robbery to happen soon any longer. This is a misjudgment, the gang leader calls his men together, distributes the guns and names the Tai Kong jewelry store as their target. Since the SWAT team was called off, the store only guarded by two policemen in a patrol car. The holdup starts when four of the robbers enter the store, draw their guns and request the jewelry. Fu and Chow wait at the entrance door to keep an eye on the street while the gang leader waits in a getaway car. When Fu folds up his coat collar, Chow realises that it was Fu who eye witnesses described as the murderer of Kam-Wah.
When the store alarm is triggered, Joe (one of the robbers) shoots a saleswoman. While they are trying to escape to their cars, the two policeman guarding the store are firing at them, wounding gang member Bill. One of the getaway cars is stopped by the police. Fu, Chow, Joe and Big Song need to leave Bill behind and are getting under heavy fire. Joe is killed by a police while Big Song tries to hot-wire another getaway car. In an audacious maneuver Fu confronts an approaching police car and kills the four policemen inside, during which he gets shot into the shoulder. Chow saves Fu's life by killing the policeman who shot at Fu. When he realises what he did he freezes whereupon Fu saves his life by pulling him out of the line of fire.
Fu, Chow, Big Song and Bony (the fourth surviving gang member) escape with the stolen car to the hideout at the harbour, where they meet the gang leader who was already awaiting them. At the scene of the firefight Chows wallet is found, which directs the police to the position of the gang.
The leader suspects a traitor among the gang since despite careful planning the police arrived quickly at the crime scene. He incriminates Chow since he only recently joined their ranks. Big Song and Fu defend Chow and a Mexican standoff emerges. Fu in particular defends Chow since he saved his life and threatens to shoot anyone who touches Chow.
The police arrives and surrounds the hideout with dozens of men and the SWAT team. When Chan requests the men to surrender, Big Song shoots at the police. They massively open fire and kill him. Bony tries to surrender and is shot by the gang leader for cowardice. When the boss also tries to shoot Chow and Fu, they kill him instead. Chow is wounded by a police bullet and his injuries are too severe to escape. He confesses to Fu that he's a cop and asks for a quick death. Fu initially can't believe his betrayal, but is unable to kill Chow. While the SWAT team storms the hideout and arrests Fu, Chow dies next to him. Lau is furious about his death and smashes a brick at Chan's head (who's already boasting to a superior about his success) and storms off.