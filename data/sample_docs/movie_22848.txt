The Great Wall

Searching for the secret of gunpowder, European mercenaries travel to China during the reign of the Renzong Emperor. A few miles north of the Great Wall, Khitan bandits attack them. Upon escaping, the survivors seek refuge in a cave but are attacked by a monster, leaving only William Garin and Pero Tovar alive. They cut off the monster's arm and bring it with them. The next day, they stumble upon the Wall and are taken prisoner by soldiers of the Nameless Order, led by General Shao and Strategist Wang.
The Nameless Order is a Chinese military order commissioned by the Imperial Court of the Song Dynasty to repel a horde of alien monsters called Tao Tieh. The monsters, one of whom William had slain, attack once every sixty years. The Order's commanders are stunned by the monster's severed hand, believing the invasion was still a week away. Suddenly, a large wave of monsters assault the Great Wall, and the Order is mobilized.
Both sides sustain heavy losses before the monsters' queen aborts the attack. During the battle, William and Tovar are freed by Ballard, a European who, like them, had ventured east twenty-five years ago in search of black powder, been detained, and now serves as an English and Latin teacher. William saves Peng Yong, a warrior, from the attacking monsters. William and Tovar's battle skills earn the Nameless Order's respect. William and Tovar meet with Ballard, plan to steal black powder, and flee while the Order is occupied in battle by the Tao Tieh.
During the night, two Tao Tieh reach the top of the Wall and kill several guards. Shao and Lin lead soldiers against them but are ambushed. The Tao Tieh are slain but Shao is killed, putting Lin in command of the Nameless Order. Around this time, an envoy from the capital Bianliang arrives with an ancient scroll which suggests that the monsters are pacified by magnets. Wang believes the stone William carries enabled him to slay the Tao Tieh he fought before entering the Wall. To test the hypothesis, William suggests they capture a Tao Tieh alive and agrees to help. This delays his escape plans, angering Tovar, who nevertheless postpones their plans to assist William over Ballard's protests.
During the next attack, the Tao Tieh are numerous enough to cause Lin to resort to using arrows equipped with black powder, whose capabilities had been kept secret from the Westerners until now. They capture a living Tao Tieh and prove the theory. The monster, however, is claimed and taken to the capital, Bianliang, by the Imperial envoy before it can be further studied. A short while later, a tunnel is discovered at the base of the Wall; the previous attacks had been a distraction, while the Tao Tieh dug a passage through the wall. While Lin investigates, Tovar and Ballard steal a supply of black powder and escape, knocking William unconscious after he tries to stop them.
William is arrested by the Chinese, and, though Peng Yong speaks up for him, is locked up in the Wall. Some distance away, Ballard betrays and abandons Tovar, but is captured by the Khitans, who accidentally kill themselves and Ballard after igniting the powder; the Chinese soldiers recapture Tovar. At the capital, the envoy presents the captive Tao Tieh to the Emperor, but it awakens and signals the Tao Tieh attack.
Rushing to protect the capital, Lin orders the use of hot-air balloons. Before setting out, Lin sets William free. Wang tells him to warn the outside world, but William boards the last balloon with Peng and Wang. They arrive just in time to save Lin from being devoured. They land in the Emperor's palace, where Wang proposes killing the queen by tying explosives to the captured Tao Tieh and giving it meat to be delivered. While transporting, a horde of Tao Tieh breach the sewers. Peng Yong sacrifices himself to save the others.
After releasing the Tao Tieh, Lin and William climb a tower for William to detonate the explosives via an arrow. Wang sacrifices himself to buy time for Lin and William to move to the upper floors. Two of William's arrows are deflected by the Tao Tieh queen's bodyguards, but William throws the magnet into the horde, creating a gap in the shields and allowing Lin's spear to get through. The queen is destroyed, and the rest of the horde is frozen solid. With the threat eliminated, William is allowed to return home and elects to take Tovar with him instead of the powder, much to Tovar's annoyance.