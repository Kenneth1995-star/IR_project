Bedazzled

Stanley Moon (Moore) works in a Wimpy's restaurant and is infatuated with the waitress Margaret Spencer (Eleanor Bron). In despair he attempts suicide but is interrupted by the Devil, incarnated as George Spiggott (Cook). ("Mr Spiggott" had previously been one of the characters in the sketch One Leg Too Few).
Spiggott is in a game with God, trying to be the first to gather 100 billion souls. If he achieves this first, he will be readmitted to Heaven. He is also busy with minor acts of vandalism and spite, helped by his staff of the seven deadly sins, notably Lust (Raquel Welch) and Envy (Barry Humphries).
In return for his soul, Spiggott offers Stanley seven wishes. Stanley uses these trying to satisfy his love for Margaret, but Spiggott twists his words to frustrate him.
Ultimately, Spiggott spares Stanley eternal damnation because he has exceeded his quota of 100 billion and can afford to be generous. Stanley is returned to his old job and life, wiser and more clear-sighted. Spiggott goes to Heaven to meet God, but is rejected again; St Peter (Lockwood West) explains that when he gave Stanley back his soul, Spiggott did the right thing, but with the wrong motive.
In the closing scene, Stanley and Margaret are back in the restaurant. Stanley finally asks her out but she says she's already doing something, though she does suggest perhaps another night. Stanley smiles, happy that he has found the courage to talk to her. Spiggott tries to entice Stanley again, but Stanley turns him down. Spiggott leaves and threatens revenge on God by unleashing all the tawdry and shallow technological curses of the modern age: