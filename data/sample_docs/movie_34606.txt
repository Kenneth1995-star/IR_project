Snowpiercer

In 2014, an attempt to counteract global warming through climate engineering backfires catastrophically, causing an ice age and extinguishing nearly all life; only polar bears and the inhabitants of Snowpiercer remain. Snowpiercer is a massive train, powered by a perpetual motion engine, traveling on a circumnavigational track created by the Wilford transportation magnate. By 2031, elites inhabit the extravagant front cars while the "scum" inhabit the tail in squalid and brutal conditions. Under watch by Wilford's guards, they are brought only gelatinous protein bars to eat.
Conspiring with his mentor Gilliam and second-in-command Edgar, Curtis Everett plans to lead the tail passengers in a revolt that will take them all the way up to the engine. Mason and armed guards come to take two small children, Andy and Timmy. Andy's father Andrew attempts to fight back, but is punished by Mason by being forced to put his arm into the extreme cold outside the train, effectively amputating it. Enraged, Curtis initiates their plan the next time they are to be fed. On realization the guards' weapons are empty, Curtis and the tail passengers easily overrun them and take the security and prison cars. Curtis releases security expert Namgoong Minsu and his clairvoyant daughter Yona from the prison car so he can disable the locks between cars, offering them a hallucinogenic drug called Kronole as payment. They take the car where insects are ground up to make their protein bars, and Gilliam suggests that if they take the subsequent water supply car, they will control any negotiation with Wilford. Instead, they are ambushed by a mass of masked men with hatchets led by Franco the Elder under Mason's orders. After a bloody battle, Curtis sacrifices Edgar to win the fight. Mason is taken captive and Curtis, Namgoong, Yona, Tanya, Andrew and Gilliam's bodyguard Grey continue on with her as a hostage.
They travel through several luxurious cars and arrive at a classroom, where the teacher expounds to the children and the rebels on the greatness of Wilford and the "sacred engine". While distracted by the celebration of the New Year marking one circumnavigation of the globe, the teacher ambushes them with a gun (bullets weren't actually extinct, but were rumored to be), killing Andrew before Grey kills her. Further back, Franco and Mason's soldiers use the same distraction to kill the rebel army and many of the tail passengers. Franco executes Gilliam, and Curtis kills Mason in revenge. Curtis' group continues forward, followed by Franco, leading to a violent fight in a sauna car during which Franco kills Grey and mortally wounds Tanya before Curtis and Namgoong seemingly kill him.
At the gate to the engine, Namgoong reveals that he plans to use the highly flammable Kronole as an explosive to blow a hatch to the outside, as he observed signs the world outside is thawing and may be hospitable. Curtis confesses to him that shortly after boarding the train, the tail passengers resorted to cannibalism to survive, and he is haunted by his part in it. He was nearly ready to kill infant Edgar when Gilliam offered his own arm instead. After years of disdain for Wilford, Curtis seeks to learn what Wilford's intentions were. Meanwhile, Franco is revealed to have survived and makes his way toward the engine.
Wilford's assistant Claude emerges from the engine, shoots Namgoong, and invites Curtis inside where he meets an aging Wilford. Wilford reveals to Curtis that his revolution was actually orchestrated by himself and Gilliam to reduce the population and maintain the balance of the sealed ecosystem, and subsequently orders the elimination of 74% of the remaining tail passengers. He explains the importance of using fear and chaos to maintain a necessary order and leadership on the train. After letting Curtis experience being alone for the first time in seventeen years, Wilford asks Curtis to replace him. Curtis appears ready to accept, when Yona runs in and pulls up a floorboard, showing Curtis that small children from the tail section, including Andy and Timmy, are being trapped as replacement parts for "extinct" machinery; the tail section only serves to provide this resource to the engine. Curtis subdues Wilford and sacrifices an arm to save Timmy from this work, though Andy refuses to be saved.
Namgoong revives and finally kills Franco as Yona lights the fuse on the Kronole. However, the door to the engine short-circuits and doesn't close, forcing Curtis and Namgoong to tightly embrace Yona and Timmy, protecting them from the blast. The explosion triggers an avalanche that derails the train. Yona and Timmy, apparently the only survivors, emerge from the wreckage and see a polar bear in the distance â€“ proof that life exists outside the train.