Spooks: The Greater Good

Set several years after the end of the TV series, Harry Pearce (Peter Firth) is still head of the counter-terrorism department (Section D) at MI5. Harry's team is transporting apprehended terrorist Adem Qasim (Elyes Gabel) through London when the convoy is attacked, allowing Qasim to escape and a CIA operative to be killed. MI5 is humiliated in the press, and relations between British and American intelligence agencies are frayed. Realising that the CIA will demand a scapegoat and that he is soon to be decommissioned from MI5, Harry seemingly commits suicide by jumping off Lambeth Bridge into the Thames.
However, it's quickly revealed Harry is alive and has faked his death so he can investigate his suspicions that Qasim's transport was sabotaged by someone high up in MI5 who is trying to destroy the organisation from the inside. Before Qasim's arrest, Harry had tasked his former section chief, Erin Watts (Lara Pulver), with going undercover inside his terrorist cell, and is quickly able to use her information to track down the fugitive Qasim, who is hiding in the English countryside. Harry does not call in MI5 and instead meets with Qasim to offer him a deal: he will get Qasim "what he wants" if he gives him the MI5 contact who helped him escape. Qasim responds by revealing he discovered Erin was an undercover agent and has taken her hostage. He shoots Erin in the stomach and tries to force Harry to finish her himself lest she die a slow death which will be recorded for her daughter to see. Harry can't bring himself to do it until Erin guides his hand in hers to shoot her and spare her daughter the video. After this, Qasim agrees to Harry's deal.
Meanwhile, Will Holloway (Kit Harington) is picked up in Moscow by MI5 operative Hannah Santo (Eleanor Matsuura) and taken back to meet with a group of senior intelligence figures; MI5 Director General Oliver Mace (Tim McInnerny), JIC Chairman Francis Warrender (David Harewood), MI5 Head of Counter-Intelligence Emerson (Elliot Levey) and MI5 Deputy Director General Geraldine Maltby (Jennifer Ehle). It's revealed Will's father worked with Harry until he was killed in action during a mission in Berlin. Thereafter Harry visited regularly throughout Will's childhood and eventually recruited him as a section D officer. Will worked closely with Harry for several years as his father did, until Harry decommissioned him citing poor performance, leaving Will with a serious grudge. The intelligence officials were not fooled by Harry's death and want Will to find him and bring him in. Will is reluctant at first but is convinced when Mace suggests Harry has information about his father's death he has not revealed.
Harry contacts Will using an old spy trick they once used to exchange information, and then organises a meet with him. Will is accompanied by an MI5 surveillance team, but Harry utilises an elaborate series of misdirections and location changes to leave the team behind and talk to Will alone. Harry reveals his suspicions about a traitor inside MI5 and asks for Will's help. Will refuses to trust Harry, but does start investigating the theory without notifying MI5. He meets with June (Tuppence Middleton) a section D officer who was involved in the botched prisoner transport, and she joins Will to investigate her partner on that mission: Robert Vass (Michael Wildman) Searching Vass' place they find bank statements indicating a pay-off and, when he arrives home, there is a fight and June kills Vass.
Later that night, the intelligence chiefs are attending an opera with some NATO officials. After the show, a suicide bomber corners JIC Chairman Warrender in the lobby and detonates, killing him alongside several other intelligence figures and military chiefs. Qasim takes credit on the news afterwards, citing it as a targeted attack on the elite rather than the public, but he is privately dissatisfied with the government response so starts to plan an attack on Oxford Circus that will kill hundreds of civilians. Harry reveals to Will that what Qasim wants from him in exchange for the contact who helped him is his wife, who MI5 traded to the FSB. Harry travels to Berlin and uses his connections there to organise a trade with the FSB—information for Qasim's wife, but Will and June intervene and attempt to take Harry back to England. Harry quickly realises June is working against them (having planted the evidence against Vass and killing him before he could deny it) and convinces Will she intends to kill them. They capture June who reveals she has been taking MI5 orders—she is so blindly loyal to the service she has been doing the traitor's work unknowingly. They leave her in Berlin, and meet with the FSB as Harry planned—unfortunately they discover Qasim's wife has died in FSB custody. They take her body and organise a meet with Qasim, claiming she is alive.
Back in the UK, Harry and Will are able to recruit Hannah to their cause, and she pretends to be Qasim's wife. Harry also recruits his old friend, retired analyst Malcolm Wynn-Jones (Hugh Simon) to monitor surveillance during the exchange. However, Qasim's agent is not fooled by Hannah's disguise and the operation is botched. Realising their original plan won't work, Harry goes off comms and, after confirming for Qasim that his wife is dead, makes a new deal with him. Fearing what deal Harry might have made, Will demands Hannah call in SCO19—they arrive, arresting Harry and Will and taking them back to MI5 HQ.
Harry reveals that Qasim has given him the location of his terrorist cell, allowing MI5 to completely neutralise the pending attack and apprehend almost all of Qasim's men. While Mace, Emerson and Maltby are interrogating Harry to discover the other side of the deal, Qasim bursts into the room with armed men, killing several personnel. To their horror, Harry reveals that for his side of the deal he gave Qasim the knowledge necessary to infiltrate MI5. After Qasim shoots and kills Calum Reed (Geoffrey Streatfield), Mace steps up and insists Qasim kill him and leave the others alone, but after Emerson takes credit for sabotaging the prisoner transport, Qasim kills him instead. While Qasim is distracted, Will works with June to get the upper hand with Qasim's men, and is able to kill them and Qasim, ending the siege. Now aware that Harry was right about there being a traitor, Mace lets him go before the authorities arrive. Will catches up to Harry and demands an explanation—Harry explains it was the only way to stop the attack and kill the traitor, and that although people still died, it was preferable to the hundreds who would have died in the attack.
A week later, Harry meets with Geraldine Maltby at a seaside home where she is playing with her niece. While her niece is outside, Harry tells her that he knows she was the one who sabotaged the prisoner transport and let Qasim escape, Emerson just claimed credit in order to protect her. She intended to destroy MI5's reputation so that it could be quietly absorbed by the Americans, who would then repay her by making her Director General of MI5, replacing Mace. Geraldine refuses to accept any consequences for her actions, so Harry reveals she doesn't have to because he poisoned her lunch hours before, and she has only two hours left to live. Harry later meets with Will beside the Thames and is warned that Ruth's grave is being watched so he can no longer visit it. Harry tells Will that the real reason he decommissioned him wasn't because he wasn't good enough, but to protect him out of respect for his father. Harry then leaves, his future unclear. The movie ends with a photo negative snapshot, a trademark of the TV show.